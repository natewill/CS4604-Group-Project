<!DOCTYPE html>
<html>
  <head>
    <title>Run App</title>
  </head>
  <body>
    <h1>Cache Me If You Can</h1>
        <div id="summary">
            <h2 id="connected"></h2>
            <p><strong>Database:</strong> <span id="db-name">connecting!</span></p>
            <p><strong>Total runners:</strong> <span id="runners-count">-</span></p>
            <p><strong>Total runs:</strong> <span id="runs-count">-</span></p>
        </div>

    <div id="error" hidden></div>


    <script>
            // Your Express server port. 5000 is typical; change if needed.
      const API_PORT = 5050;
      const API_BASE = `http://localhost:${API_PORT}`;

      async function fetchJSON(url) { //function to safely fetch json
        const res = await fetch(url);
        if (!res.ok) throw new Error(`${res.status} ${res.statusText}`);
        return res.json();
      }

      async function getData() { //get data from api
        try {
            json = await fetchJSON(`${API_BASE}/api/summary`) 
            return json
         } catch (_) {
            console.log(err)
        }
    };

    async function init() { //start interface
      
      summaryData = await getData() //get json data from api

      //display it
      document.getElementById("connected").textContent = "Database Connected!"
      document.getElementById("db-name").textContent = summaryData.dbName;
      document.getElementById("runners-count").textContent = summaryData.runnersCount;
      document.getElementById("runs-count").textContent = summaryData.runsCount;
    }

    init()

    </script>
  </body>
</html>